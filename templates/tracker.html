<!DOCTYPE html>
<html>
<head>
<title>Bus Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
margin:0;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
background:linear-gradient(135deg,#070b1a,#0a1f44,#1a0f3d);
font-family:Arial;
color:white;
}

.card{
padding:40px;
border-radius:15px;
background:rgba(20,30,60,0.4);
backdrop-filter:blur(15px);
text-align:center;
}

button{
padding:15px 20px;
margin:10px;
border:none;
border-radius:10px;
background:#00d4ff;
color:white;
cursor:pointer;
}

input{
padding:10px;
border-radius:10px;
border:none;
margin-bottom:10px;
width:100%;
}
</style>
</head>

<body>

<div class="card">

<h2>ðŸšŒ Smart Bus Tracker</h2>

<input id="busNumber" placeholder="Bus Number (optional)">

<br>

<button onclick="shareLocation()">
Share Bus Location
</button>

<button onclick="viewLocation()">
View Bus Location
</button>

</div>

<script>

let watchId;

function shareLocation(){

let bus = document.getElementById("busNumber").value || "default";

localStorage.setItem("sharing","true");
localStorage.setItem("bus",bus);

navigator.geolocation.watchPosition(

function(pos){

fetch("/update_location",{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({
lat:pos.coords.latitude,
lng:pos.coords.longitude,
bus:bus
})

});

},

function(error){
alert("Please allow location permission.");
},

{
enableHighAccuracy:true
}
);

window.location="/viewer";

}

function viewLocation(){
localStorage.setItem("sharing","false");
window.location="/viewer";
}

</script>

</body>
</html>
